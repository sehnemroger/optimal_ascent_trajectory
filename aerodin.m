function [FA,FN,FAr,FAu,FAv,FNr,FNu,FNv,FNbeta,HessFA,HessFN]=aerodin(t,X,U,region,Foguete)

r=X(1); sigma=X(2); u=X(3); v=X(4); m=X(5);
beta=U(1);
i=Foguete.i;
WE=7.292115856e-5; % modulo da velociodade angular da terra
aux=(v-r*WE*cos(i));
gama=atan2(u,aux);
alfa=beta-gama;
RE=6378145;%raio médio da terra.
%% Altitude do Foguete  no tempo (t)
h=r-RE;
% ie=estagio(t,Foguete);
ie=region;
% Tnom=tracao(h,ie,Foguete); %ie corresponde ao estágio atual
% VR é o modulo da velocidaade do veiculo com relação à atmosfera
VR=(u^2+(v-r*WE*cos(i))^2)^0.5; %i é a inclinação do plano da orbita com relação ao equador.
Mach=VR/Vsom(h);
[FA,FN,Cx,gradCx,HessCx,CNx,gradCNx,HessCNx,rhoe]=FAero(Mach,alfa,X,VR,ie,Foguete);
%Parciais de Cx
Cxr=gradCx(1); Cxu=gradCx(2); Cxv=gradCx(3);
Cxrr=HessCx(1,1); Cxru=HessCx(1,2); Cxrv=HessCx(1,3);
Cxur=HessCx(2,1); Cxuu=HessCx(2,2); Cxuv=HessCx(2,3);
Cxvr=HessCx(3,1); Cxvu=HessCx(3,2); Cxvv=HessCx(3,3);
%Parciais de CNx
CNxr=gradCNx(1); CNxu=gradCNx(2); CNxv=gradCNx(3);
CNxrr=HessCNx(1,1); CNxru=HessCNx(1,2); CNxrv=HessCNx(1,3);
CNxur=HessCNx(2,1); CNxuu=HessCNx(2,2); CNxuv=HessCNx(2,3);
CNxvr=HessCNx(3,1); CNxvu=HessCNx(3,2); CNxvv=HessCNx(3,3);
[rhoer,rhoerr]=rho_devs(r);

cosi=cos(i); Sref=Foguete.Sref;
gradFA=[(1/2).*Sref.*(Cxr.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+Cx.*(2.* ...
    cosi.*rhoe.*WE.*((-1).*v+cosi.*r.*WE)+rhoer.*(u.^2+(v+(-1).*cosi.* ...
    r.*WE).^2))),(1/2).*rhoe.*Sref.*(2.*Cx.*u+Cxu.*(u.^2+(v+(-1).* ...
    cosi.*r.*WE).^2)),(1/2).*rhoe.*Sref.*(2.*Cx.*(v+(-1).*cosi.*r.*WE) ...
    +Cxv.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))];
gradGama=[cosi.*u.*WE.*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-1),(v+(-1).* ...
    cosi.*r.*WE).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-1),(-1).*u.*( ...
    u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-1)];

gamar=gradGama(1); gamau=gradGama(2); gamav=gradGama(3);

gradFN=[(1/2).*Sref.*(CNxr.*(beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).* ...
    cosi.*r.*WE).^2)+CNx.*((-1).*gamar.*rhoe.*(u.^2+(v+(-1).*cosi.*r.* ...
    WE).^2)+(beta+(-1).*gama).*(2.*cosi.*rhoe.*WE.*((-1).*v+cosi.*r.* ...
    WE)+rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)))),(1/2).*rhoe.*Sref.*( ...
    CNxu.*(beta+(-1).*gama).*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+CNx.*(2.* ...
    beta.*u+(-2).*gama.*u+(-1).*gamau.*(u.^2+(v+(-1).*cosi.*r.*WE).^2) ...
    )),(1/2).*rhoe.*Sref.*(CNxv.*(beta+(-1).*gama).*(u.^2+(v+(-1).* ...
    cosi.*r.*WE).^2)+CNx.*(2.*(beta+(-1).*gama).*(v+(-1).*cosi.*r.*WE) ...
    +(-1).*gamav.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)))];
FAr=gradFA(1); FAu=gradFA(2); FAv=gradFA(3);
FNr=gradFN(1); FNu=gradFN(2); FNv=gradFN(3);
FNbeta=(1/2).*CNx.*rhoe.*Sref.*(u.^2+(v+(-1).*cosi.*r.*WE).^2);

if nargout > 9
    HessFA=[(1/2).*Sref.*(Cxrr.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+2.* ...
        Cxr.*(2.*cosi.*rhoe.*WE.*((-1).*v+cosi.*r.*WE)+rhoer.*(u.^2+(v+( ...
        -1).*cosi.*r.*WE).^2))+Cx.*(2.*cosi.*WE.*((-2).*rhoer.*v+cosi.*( ...
        rhoe+2.*r.*rhoer).*WE)+rhoerr.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))),( ...
        1/2).*(rhoe.*Sref.*(2.*Cxr.*u+2.*cosi.*Cxu.*WE.*((-1).*v+cosi.*r.* ...
        WE)+Cxru.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))+rhoer.*Sref.*(2.*Cx.*u+ ...
        Cxu.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))),(1/2).*Sref.*((-2).*Cx.*(( ...
        -1).*rhoer.*v+cosi.*(rhoe+r.*rhoer).*WE)+Cxv.*rhoer.*(u.^2+(v+(-1) ...
        .*cosi.*r.*WE).^2)+rhoe.*(Cxrv.*u.^2+(v+(-1).*cosi.*r.*WE).*(2.* ...
        Cxr+(-2).*cosi.*Cxv.*WE+Cxrv.*(v+(-1).*cosi.*r.*WE))));(1/2).*( ...
        rhoer.*Sref.*(2.*Cx.*u+Cxu.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))+ ...
        rhoe.*Sref.*(2.*Cxr.*u+2.*cosi.*Cxu.*WE.*((-1).*v+cosi.*r.*WE)+ ...
        Cxur.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))),(1/2).*rhoe.*Sref.*(2.*Cx+ ...
        4.*Cxu.*u+Cxuu.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)),(1/2).*rhoe.* ...
        Sref.*(2.*Cxv.*u+2.*Cxu.*(v+(-1).*cosi.*r.*WE)+Cxuv.*(u.^2+(v+(-1) ...
        .*cosi.*r.*WE).^2));(1/2).*Sref.*((-2).*Cx.*((-1).*rhoer.*v+cosi.* ...
        (rhoe+r.*rhoer).*WE)+Cxv.*rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+ ...
        rhoe.*(2.*(Cxr+(-1).*cosi.*Cxv.*WE).*(v+(-1).*cosi.*r.*WE)+Cxvr.*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2))),(1/2).*rhoe.*Sref.*(2.*Cxv.*u+2.* ...
        Cxu.*(v+(-1).*cosi.*r.*WE)+Cxvu.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)), ...
        (1/2).*rhoe.*Sref.*(2.*Cx+4.*Cxv.*(v+(-1).*cosi.*r.*WE)+Cxvv.*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2))];
    HessGama=[2.*cosi.^2.*u.*WE.^2.*(v+(-1).*cosi.*r.*WE).*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2).^(-2),cosi.*WE.*((-1).*u.^2+(v+(-1).*cosi.*r.*WE) ...
        .^2).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2),(-2).*cosi.*u.*WE.*(v+ ...
        (-1).*cosi.*r.*WE).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2);cosi.* ...
        WE.*((-1).*u.^2+(v+(-1).*cosi.*r.*WE).^2).*(u.^2+(v+(-1).*cosi.* ...
        r.*WE).^2).^(-2),(-2).*u.*(v+(-1).*cosi.*r.*WE).*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2).^(-2),(u.^2+(-1).*(v+(-1).*cosi.*r.*WE).^2).*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2);(-2).*cosi.*u.*WE.*(v+(-1).* ...
        cosi.*r.*WE).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2),(u.^2+(-1).*( ...
        v+(-1).*cosi.*r.*WE).^2).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2), ...
        2.*u.*(v+(-1).*cosi.*r.*WE).*(u.^2+(v+(-1).*cosi.*r.*WE).^2).^(-2) ...
        ];
    gamarr=HessGama(1,1); gamaru=HessGama(1,2); gamarv=HessGama(1,3);
    gamaur=HessGama(2,1); gamauu=HessGama(2,2); gamauv=HessGama(2,3);
    gamavr=HessGama(3,1); gamavu=HessGama(3,2); gamavv=HessGama(3,3);
    HessFN=[(1/2).*Sref.*(CNxrr.*(beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2)+2.*CNxr.*((-1).*gamar.*rhoe.*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2)+(beta+(-1).*gama).*(2.*cosi.*rhoe.*WE.*((-1).*v+ ...
        cosi.*r.*WE)+rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)))+CNx.*((-2).* ...
        gamar.*rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+rhoe.*(2.*cosi.*WE.* ...
        (cosi.*(beta+(-1).*gama).*WE+2.*gamar.*(v+(-1).*cosi.*r.*WE))+(-1) ...
        .*gamarr.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))+(beta+(-1).*gama).*(4.* ...
        cosi.*rhoer.*WE.*((-1).*v+cosi.*r.*WE)+rhoerr.*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2)))),(1/2).*Sref.*(2.*CNxr.*(beta+(-1).*gama).* ...
        rhoe.*u+(-2).*CNx.*gamar.*rhoe.*u+2.*CNx.*(beta+(-1).*gama).* ...
        rhoer.*u+2.*CNx.*cosi.*gamau.*rhoe.*WE.*(v+(-1).*cosi.*r.*WE)+2.* ...
        CNxu.*cosi.*(beta+(-1).*gama).*rhoe.*WE.*((-1).*v+cosi.*r.*WE)+ ...
        CNxru.*(beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+( ...
        -1).*CNxu.*gamar.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).* ...
        CNx.*gamaru.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNxr.* ...
        gamau.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+CNxu.*(beta+(-1).* ...
        gama).*rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.*gamau.* ...
        rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)),(1/2).*Sref.*(2.*CNx.* ...
        cosi.*((-1).*beta+gama).*rhoe.*WE+2.*CNxr.*(beta+(-1).*gama).* ...
        rhoe.*(v+(-1).*cosi.*r.*WE)+(-2).*CNx.*gamar.*rhoe.*(v+(-1).* ...
        cosi.*r.*WE)+2.*CNx.*(beta+(-1).*gama).*rhoer.*(v+(-1).*cosi.*r.* ...
        WE)+2.*CNx.*cosi.*gamav.*rhoe.*WE.*(v+(-1).*cosi.*r.*WE)+2.*CNxv.* ...
        cosi.*(beta+(-1).*gama).*rhoe.*WE.*((-1).*v+cosi.*r.*WE)+CNxrv.*( ...
        beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).* ...
        CNxv.*gamar.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.* ...
        gamarv.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNxr.*gamav.* ...
        rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+CNxv.*(beta+(-1).*gama).* ...
        rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.*gamav.*rhoer.*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2));(1/2).*Sref.*(2.*CNxr.*(beta+(-1) ...
        .*gama).*rhoe.*u+(-2).*CNx.*gamar.*rhoe.*u+2.*CNx.*(beta+(-1).* ...
        gama).*rhoer.*u+2.*CNx.*cosi.*gamau.*rhoe.*WE.*(v+(-1).*cosi.*r.* ...
        WE)+2.*CNxu.*cosi.*(beta+(-1).*gama).*rhoe.*WE.*((-1).*v+cosi.*r.* ...
        WE)+CNxur.*(beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE) ...
        .^2)+(-1).*CNxu.*gamar.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1) ...
        .*CNxr.*gamau.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.* ...
        gamaur.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+CNxu.*(beta+(-1).* ...
        gama).*rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.*gamau.* ...
        rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)),(1/2).*rhoe.*Sref.*((-2).* ...
        CNxu.*gamau.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(beta+(-1).*gama).*( ...
        4.*CNxu.*u+CNxuu.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))+CNx.*(2.*beta+( ...
        -2).*gama+(-4).*gamau.*u+(-1).*gamauu.*(u.^2+(v+(-1).*cosi.*r.*WE) ...
        .^2))),(1/2).*rhoe.*Sref.*(2.*CNxv.*(beta+(-1).*gama).*u+(-2).* ...
        CNx.*gamav.*u+2.*CNxu.*(beta+(-1).*gama).*(v+(-1).*cosi.*r.*WE)+( ...
        -2).*CNx.*gamau.*(v+(-1).*cosi.*r.*WE)+CNxuv.*(beta+(-1).*gama).*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNxv.*gamau.*(u.^2+(v+(-1).* ...
        cosi.*r.*WE).^2)+(-1).*CNx.*gamauv.*(u.^2+(v+(-1).*cosi.*r.*WE) ...
        .^2)+(-1).*CNxu.*gamav.*(u.^2+(v+(-1).*cosi.*r.*WE).^2));(1/2).* ...
        Sref.*(2.*CNx.*cosi.*((-1).*beta+gama).*rhoe.*WE+2.*CNxr.*(beta+( ...
        -1).*gama).*rhoe.*(v+(-1).*cosi.*r.*WE)+(-2).*CNx.*gamar.*rhoe.*( ...
        v+(-1).*cosi.*r.*WE)+2.*CNx.*(beta+(-1).*gama).*rhoer.*(v+(-1).* ...
        cosi.*r.*WE)+2.*CNx.*cosi.*gamav.*rhoe.*WE.*(v+(-1).*cosi.*r.*WE)+ ...
        2.*CNxv.*cosi.*(beta+(-1).*gama).*rhoe.*WE.*((-1).*v+cosi.*r.*WE)+ ...
        CNxvr.*(beta+(-1).*gama).*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+( ...
        -1).*CNxv.*gamar.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).* ...
        CNxr.*gamav.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.* ...
        gamavr.*rhoe.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+CNxv.*(beta+(-1).* ...
        gama).*rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.*gamav.* ...
        rhoer.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)),(1/2).*rhoe.*Sref.*(2.* ...
        CNxv.*(beta+(-1).*gama).*u+(-2).*CNx.*gamav.*u+2.*CNxu.*(beta+(-1) ...
        .*gama).*(v+(-1).*cosi.*r.*WE)+(-2).*CNx.*gamau.*(v+(-1).*cosi.* ...
        r.*WE)+CNxvu.*(beta+(-1).*gama).*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+( ...
        -1).*CNxv.*gamau.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNxu.* ...
        gamav.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)+(-1).*CNx.*gamavu.*(u.^2+( ...
        v+(-1).*cosi.*r.*WE).^2)),(1/2).*rhoe.*Sref.*((-2).*CNxv.*gamav.*( ...
        u.^2+(v+(-1).*cosi.*r.*WE).^2)+(beta+(-1).*gama).*(4.*CNxv.*(v+( ...
        -1).*cosi.*r.*WE)+CNxvv.*(u.^2+(v+(-1).*cosi.*r.*WE).^2))+CNx.*( ...
        2.*beta+(-2).*gama+(-4).*gamav.*(v+(-1).*cosi.*r.*WE)+(-1).* ...
        gamavv.*(u.^2+(v+(-1).*cosi.*r.*WE).^2)))];
end
end